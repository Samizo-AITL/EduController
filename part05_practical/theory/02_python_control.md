---
layout: default
title: 02. Pythonã«ã‚ˆã‚‹åˆ¶å¾¡è¨­è¨ˆã®åŸºæœ¬
---

<!-- MathJax support for both inline and block math -->
<script type="text/javascript">
  window.MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
    svg: { fontCache: 'global' }
  };
</script>
<script type="text/javascript"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

# ğŸ 02. Pythonã«ã‚ˆã‚‹åˆ¶å¾¡è¨­è¨ˆã®åŸºæœ¬ï¼ˆControl System Design in Pythonï¼‰

æœ¬ç¯€ã§ã¯ã€Pythonåˆ¶å¾¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆ`control`, `scipy`ï¼‰ã‚’ç”¨ã„ãŸ  
**åŸºæœ¬çš„ãªåˆ¶å¾¡ç³»è¨­è¨ˆãƒ»è§£ææ‰‹æ³•**ã‚’å­¦ã³ã¾ã™ã€‚  
MATLABã¨é¡ä¼¼ã®æ“ä½œæ€§ã‚’æŒã¡ã€å¤å…¸ã€œçŠ¶æ…‹ç©ºé–“ã¾ã§å¹…åºƒãå¯¾å¿œã§ãã¾ã™ã€‚

---

## ğŸ¯ å­¦ç¿’ç›®æ¨™

- Pythonã§ä¼é”é–¢æ•°ãƒ»çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã§ãã‚‹  
- ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ãƒ»æ¥µé…ç½®ãƒ»ãƒœãƒ¼ãƒ‰ç·šå›³ãªã©ã®è§£æãŒã§ãã‚‹  
- é–‰ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡ç³»ã‚’æ§‹æˆã—ã€å¿œç­”ã‚’å¯è¦–åŒ–ã§ãã‚‹  
- Pythonã¨MATLABã®æ§‹æ–‡çš„ãªé•ã„ã«æ…£ã‚Œã‚‹

---

## ğŸ” 1. ä¼é”é–¢æ•°ã®å®šç¾©ã¨å¿œç­”è§£æ

```python
import control
import matplotlib.pyplot as plt

# G(s) = 1 / (s^2 + 2s + 1)
num = [1]
den = [1, 2, 1]
G = control.tf(num, den)

# ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”
t, y = control.step_response(G)
plt.plot(t, y)
plt.title("Step Response")
plt.grid()
plt.show()
```

---

## ğŸ§® 2. çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©ã¨è§£æ

Pythonã§ã¯ `control.ss()` é–¢æ•°ã‚’ä½¿ã£ã¦çŠ¶æ…‹ç©ºé–“è¡¨ç¾ï¼ˆState-Spaceï¼‰ã‚’æ§‹æˆã§ãã¾ã™ã€‚

### çŠ¶æ…‹ç©ºé–“ãƒ¢ãƒ‡ãƒ«ã®ä¸€èˆ¬å½¢

$$
\begin{aligned}
\dot{x}(t) &= A x(t) + B u(t) \\\\
y(t) &= C x(t) + D u(t)
\end{aligned}
$$

```python
import control

# ãƒ¢ãƒ‡ãƒ«å®šç¾©
A = [[0, 1],
     [-1, -2]]
B = [[0],
     [1]]
C = [[1, 0]]
D = [[0]]

sys_ss = control.ss(A, B, C, D)

# å›ºæœ‰å€¤ï¼ˆæ¥µï¼‰ã®å–å¾—
poles = control.pole(sys_ss)
print("Poles:", poles)
```

	â€¢	control.ss(A, B, C, D)ï¼šçŠ¶æ…‹ç©ºé–“ã‚·ã‚¹ãƒ†ãƒ ã‚’å®šç¾©
	â€¢	control.pole(sys_ss)ï¼šå›ºæœ‰å€¤ã‚’ç®—å‡º â†’ å®‰å®šæ€§ã‚’ç¢ºèª

---

## ğŸ” 3. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç³»ã®æ§‹æˆ

åˆ¶å¾¡ç³»ã§ã¯ã€**è² å¸°é‚„æ§‹é€ **ã‚’ç”¨ã„ã¦å‡ºåŠ›ã®å®‰å®šåŒ–ã‚„èª¤å·®ä½æ¸›ã‚’å®Ÿç¾ã—ã¾ã™ã€‚  
Pythonã§ã¯ `control.feedback()` ã‚’ä½¿ã£ã¦ç°¡å˜ã«é–‰ãƒ«ãƒ¼ãƒ—ç³»ã‚’æ§‹æˆã§ãã¾ã™ã€‚

### ä¾‹ï¼šæ¯”ä¾‹ã‚²ã‚¤ãƒ³ã«ã‚ˆã‚‹é–‰ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡

å¯¾è±¡ãƒ—ãƒ©ãƒ³ãƒˆï¼š

$$
G(s) = \frac{1}{s^2 + 2s + 1}
$$

åˆ¶å¾¡å™¨ï¼š $K=2$ ã®æ¯”ä¾‹åˆ¶å¾¡ã¨ã™ã‚‹ã€‚

```python
import control
import matplotlib.pyplot as plt

# ãƒ—ãƒ©ãƒ³ãƒˆï¼ˆä¼é”é–¢æ•°ï¼‰
G = control.tf([1], [1, 2, 1])
K = 2.0  # æ¯”ä¾‹ã‚²ã‚¤ãƒ³

# è² å¸°é‚„ç³»ï¼ˆé–‰ãƒ«ãƒ¼ãƒ—ç³»ï¼‰ã®æ§‹ç¯‰
G_cl = control.feedback(K * G, 1)

# ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã®ãƒ—ãƒ­ãƒƒãƒˆ
t, y = control.step_response(G_cl)
plt.plot(t, y)
plt.title("Closed-loop Step Response")
plt.xlabel("Time [s]")
plt.ylabel("Output")
plt.grid()
plt.show()
```

---

## ğŸ” 4. ãƒœãƒ¼ãƒ‰ç·šå›³ã¨å®‰å®šä½™è£•ã®ç¢ºèª

å‘¨æ³¢æ•°é ˜åŸŸã®ç‰¹æ€§ã¯ã€åˆ¶å¾¡ç³»ã®å®‰å®šæ€§ã‚„ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’è©•ä¾¡ã™ã‚‹ä¸Šã§æ¥µã‚ã¦é‡è¦ã§ã™ã€‚  
Pythonã§ã¯ `control.bode()` é–¢æ•°ã§**ãƒœãƒ¼ãƒ‰ç·šå›³ï¼ˆæŒ¯å¹…ãƒ»ä½ç›¸ï¼‰**ã‚’æç”»ã§ãã¾ã™ã€‚

### Bodeç·šå›³ã¨ã¯ï¼Ÿ

- **ã‚²ã‚¤ãƒ³ç‰¹æ€§**ï¼ˆæŒ¯å¹… vs å‘¨æ³¢æ•°ï¼‰
- **ä½ç›¸ç‰¹æ€§**ï¼ˆä½ç›¸ vs å‘¨æ³¢æ•°ï¼‰

ã“ã‚Œã‚‰ã‚’å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ã§æãã“ã¨ã§ã€**ãƒ•ã‚£ãƒ«ã‚¿ç‰¹æ€§ãƒ»ä½ç›¸é…ã‚Œãƒ»å®‰å®šä½™è£•**ãŒè¦–è¦šçš„ã«æŠŠæ¡ã§ãã¾ã™ã€‚

---

### âœ… Pythonã«ã‚ˆã‚‹Bodeç·šå›³ã®æç”»

```python
import control
import matplotlib.pyplot as plt

# ä¼é”é–¢æ•° G(s)
G = control.tf([1], [1, 2, 1])

# Bodeãƒ—ãƒ­ãƒƒãƒˆï¼ˆdBè¡¨è¨˜ã€Hzã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
mag, phase, omega = control.bode(G, dB=True, Hz=True)
plt.show()
```

---

### ğŸ“ å®‰å®šä½™è£•ã®ç®—å‡º

`control.margin()` ã‚’ä½¿ãˆã°ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’æ•°å€¤ã¨ã—ã¦å–å¾—ã§ãã¾ã™ï¼š

- **ã‚²ã‚¤ãƒ³ä½™è£•ï¼ˆGain Marginï¼‰**ï¼šåˆ©å¾—ãŒä½•å€ã¾ã§å¢—åŠ ã—ã¦ã‚‚å®‰å®šã‹ï¼ˆdBã§è¡¨è¨˜ï¼‰
- **ä½ç›¸ä½™è£•ï¼ˆPhase Marginï¼‰**ï¼šä½•åº¦ã®ä½ç›¸é…ã‚Œã¾ã§è¨±å®¹ã•ã‚Œã‚‹ã‹ï¼ˆdegï¼‰
- **ã‚²ã‚¤ãƒ³äº¤å·®å‘¨æ³¢æ•°ï¼ˆGain crossover frequencyï¼‰**ï¼š|G(jÏ‰)| = 1ï¼ˆ0dBï¼‰ã¨ãªã‚‹å‘¨æ³¢æ•°
- **ä½ç›¸äº¤å·®å‘¨æ³¢æ•°ï¼ˆPhase crossover frequencyï¼‰**ï¼šâˆ G(jÏ‰) = -180Â°ã¨ãªã‚‹å‘¨æ³¢æ•°

```python
import control

G = control.tf([1], [1, 2, 1])
gm, pm, wg, wp = control.margin(G)

print(f"Gain Margin  : {gm:.2f}")
print(f"Phase Margin : {pm:.2f} deg")
print(f"Gain Crossover Freq : {wg:.2f} rad/s")
print(f"Phase Crossover Freq: {wp:.2f} rad/s")
```
ã“ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€å®‰å®šæ€§ã®ä½™è£•ã¨å¿œç­”ã®ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’è©•ä¾¡ã§ãã¾ã™ã€‚

---

### âš ï¸ å®‰å®šä½™è£•ã®è¨­è¨ˆåŸºæº–ï¼ˆç›®å®‰ï¼‰

åˆ¶å¾¡ç³»ã®è¨­è¨ˆã§ã¯ã€ã‚²ã‚¤ãƒ³ä½™è£•ï¼ˆGMï¼‰ã‚„ä½ç›¸ä½™è£•ï¼ˆPMï¼‰ã‚’**ã‚ã‚‹ç¨‹åº¦ç¢ºä¿**ã—ã¦ãŠãã“ã¨ã§ã€  
ãƒ¢ãƒ‡ãƒ«èª¤å·®ãƒ»ãƒã‚¤ã‚ºãƒ»é…å»¶ãªã©ã«å¯¾ã—ã¦**ãƒ­ãƒã‚¹ãƒˆãªå®‰å®šæ€§**ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

| æŒ‡æ¨™              | æ¨å¥¨ç¯„å›²         | èª¬æ˜                                      |
|-------------------|------------------|-------------------------------------------|
| ã‚²ã‚¤ãƒ³ä½™è£• (GM)   | â‰§ 6 dB           | ã‚²ã‚¤ãƒ³ãŒ6 dBå¢—åŠ ã—ã¦ã‚‚ä¸å®‰å®šåŒ–ã—ãªã„     |
| ä½ç›¸ä½™è£• (PM)     | â‰§ 30ã€œ45 åº¦      | é…å»¶ã‚„è¿‘ä¼¼èª¤å·®ã«å¯¾ã™ã‚‹ä½™è£•ãŒã‚ã‚‹          |
| ã‚¯ãƒ­ã‚¹å‘¨æ³¢æ•°       | æ•° Hzã€œæ•° kHz     | å¿œç­”é€Ÿåº¦ã®æŒ‡æ¨™ï¼ˆé«˜ã™ãã‚‹ã¨ãƒã‚¤ã‚ºã«å¼±ã„ï¼‰ |

> âš ï¸ **æ³¨æ„**ï¼šé«˜ã„å¿œç­”æ€§ï¼ˆé€Ÿã•ï¼‰ã‚’æ±‚ã‚ã™ãã‚‹ã¨ã€ä½ç›¸ä½™è£•ãŒä¸è¶³ã—ã¦**æŒ¯å‹•**ã‚„**ç™ºæ•£**ã‚’å¼•ãèµ·ã“ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

---

## ğŸ“˜ ã¾ã¨ã‚

| æ©Ÿèƒ½                    | Pythoné–¢æ•°                             |
|-------------------------|----------------------------------------|
| Bodeç·šå›³ã®æç”»          | `control.bode(sys)`                    |
| å®‰å®šä½™è£•ã®æ•°å€¤å–å¾—      | `gm, pm, wg, wp = control.margin(sys)` |
| ã‚²ã‚¤ãƒ³äº¤å·®å‘¨æ³¢æ•°ã®å–å¾—  | `wg`                                   |
| ä½ç›¸äº¤å·®å‘¨æ³¢æ•°ã®å–å¾—    | `wp`                                   |

å®‰å®šä½™è£•ã¯ã€**åˆ¶å¾¡å¯¾è±¡ãŒæœªçŸ¥æˆåˆ†ã‚’å«ã‚€å ´åˆ**ã‚„**åˆ¶å¾¡å™¨è¨­è¨ˆã®åˆæœŸæ¤œè¨¼æ®µéš**ã§ç‰¹ã«é‡è¦ã§ã™ã€‚

---

## ğŸ“š å‚è€ƒè³‡æ–™

- [Python Control Systems Library Documentation](https://python-control.readthedocs.io/)
- Franklin, Powell & Emami-Naeini, *Feedback Control of Dynamic Systems*
- Nise, *Control Systems Engineering*
- MATLAB Control Toolbox ã¨ã®æ¯”è¼ƒï¼š`02_simulation_setup.md` å‚ç…§

---





ã€€

