# 🎯 02. モデル参照型適応制御（MRAC：Model Reference Adaptive Control）

**MRAC**は、制御対象（Plant）に対して、**理想的な動作をする「参照モデル」**を設定し、  
そのモデルに近づくように制御器のパラメータを**リアルタイムに調整**する適応制御の代表的手法です。

---

## 🎯 学習目標

- MRACの基本構造と考え方を理解する  
- MITルールによる適応律の導出手順を説明できる  
- 状態・出力誤差を使ってゲイン更新ができる意味を理解する  
- PythonでMRACのシンプルな実装ができる

---

## ⚙️ MRACの基本構成

```
            +----------------+
   r(t) ──▶ | 参照モデル M   | ───▶ y_m(t)
            +----------------+
                     │
                     ▼
                 e(t) = y_m(t) - y(t)
                     │
                     ▼
            +---------------------+
            | 可変制御器（θ）      |
            | θ：適応パラメータ    |
            +---------------------+
                     │
                     ▼
                   u(t)
                     │
                     ▼
            +----------------+
            | プラント P      |
            +----------------+
                     │
                     ▼
                   y(t)
```

---

## 📘 例：1次系へのMRAC適用

### 📌 対象プラント（未知）

$$
P(s) = \frac{k}{\tau s + 1}
$$

- $k$ や $\tau$ が未知だが、**正の安定系**とする

### 📌 参照モデル

$$
M(s) = \frac{1}{T_m s + 1}
$$

- 目標の応答特性を示す安定なモデル

---

## 🧠 可変制御器の構成（例）

$$
u(t) = \theta_1 r(t) + \theta_2 y(t)
$$

- $\theta_1$, $\theta_2$ は**リアルタイムに学習**されるパラメータ

---

## 🔁 MITルールによるパラメータ更新（例）

### 誤差：

$$
e(t) = y(t) - y_m(t)
$$

### コスト関数：

$$
J(\theta) = \frac{1}{2} e(t)^2
$$

### パラメータ更新則（勾配法）：

$$
\dot{\theta}_i = -\gamma_i \frac{\partial J}{\partial \theta_i} = -\gamma_i e(t) \frac{\partial e(t)}{\partial \theta_i}
$$

- $\gamma_i$：適応ゲイン（学習率）
- $e$ の $\theta_i$ に対する感度を使う

---

## 📐 実装上の注意点

- **$\gamma_i$ が大きすぎると発散、小さすぎると学習しない**  
- ノイズに敏感なため、フィルタ処理やロバスト化が必要  
- Lyapunov安定性理論による更新則もよく使われる（後述）

---

## 🧪 シミュレーション要素（次章にて）

- 1次プラント + MRAC適応器（ $\theta_1$, $\theta_2$ ）  
- ステップ入力に対し、$y(t)$ が $y_m(t)$ に近づくか確認  
- $\theta_i(t)$ の時間変化も可視化

---

## 📚 参考資料

- Ioannou & Sun, *Robust Adaptive Control*  
- Åström & Wittenmark, *Adaptive Control*  
- Slotine & Li, *Applied Nonlinear Control*

---
