# 🔀 03. ゲインスケジューリング制御（Gain Scheduling）

**ゲインスケジューリング（GS）**は、制御対象の状態や外部条件に応じて、  
**制御ゲイン（K）をリアルタイムで切り替える／補間する**手法です。

航空機、自動車、化学プラントなど、**非線形・広範囲な動作をするシステム**において、  
シンプルかつ実用的な適応戦略として広く用いられています。

---

## 🎯 学習目標

- ゲインスケジューリングの基本的考え方を理解する  
- スケジューリング変数と局所モデルの関係を説明できる  
- パラメータの補間／切り替えによるゲイン設計ができる  
- Pythonで簡易的なGS制御器を構築できるようになる

---

## 🔧 基本構造

1. **スケジューリング変数 $\rho(t)$** を選定（例：速度、温度、高度など）  
2. 各 $\rho_i$ に対してローカル制御器 $K_i$ を設計  
3. 現在の $\rho(t)$ に基づき、$K(\rho)$ を選択／補間して適用

---

## 📘 例：航空機の飛行モード切替

| 状態 $\rho$ | モード      | 制御器設計 | コメント |
|-------------|-------------|-------------|----------|
| $\rho = 0$  | 巡航       | $K_1$       | 中速安定 |
| $\rho = 1$  | 上昇       | $K_2$       | 推力強化 |
| $\rho = 2$  | 旋回       | $K_3$       | 応答性重視 |

---

## ✅ 数学的モデル（線形補間）

ゲインの例：

$$
K(\rho) = (1 - \alpha) K_1 + \alpha K_2 \quad (\rho \in [0, 1], \alpha = \frac{\rho - \rho_1}{\rho_2 - \rho_1})
$$

- ゲインを連続的に変化させることで、応答のスムーズさを保つ  
- 状態空間モデルも $\rho$ に依存する： $A(\rho), B(\rho)$

---

## 🧪 Python実装イメージ（補間）

```python
def gain_schedule(rho):
    if rho < 1.0:
        K = (1 - rho) * K1 + rho * K2
    else:
        K = K2
    return K
```

- 時刻や外部変数に応じて制御器を動的に切り替え
- スムーズな補間を行えば過渡応答も良好になる

---

## 🖼️ AITL-Hとの接続例
- FSM層の状態遷移に応じて、異なるゲインを適用（モード切替）
- PIDや状態フィードバックのゲインに対してGSを導入
- LLM層がスケジューリング変数を「予測・分類」する補助も可能

---

## ⚠️ 注意点と限界
- 線形モデル設計の妥当性：各動作点ごとにモデルが必要
- スムーズな補間性を保証しないと、不連続な挙動になる
- 非線形系への厳密な適用は難しい → LPVや非線形GSが研究中

---

## 📚 参考資料
- Nise, Control Systems Engineering
- Stevens & Lewis, Aircraft Control and Simulation
- Takagi-Sugeno系のファジィ推論（非線形GSの拡張）

---
