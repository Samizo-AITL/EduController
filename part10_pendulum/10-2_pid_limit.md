---
layout: clean
title: 📉 10-2 PID制御の限界：なぜ倒立振子は安定しないのか
permalink: /part10_pendulum/10-1_model.html
---

# 10-2 PID制御の限界  
## なぜ倒立振子は安定しないのか

本章では、**10-1で得た線形モデル**に対して  
「PID制御だけで何が起きるか」を **逃げずに示す**。

結論は先に書く。

> **倒立振子は、PIDでは「たまたま立つ」ことはあっても、  
> 安定性を保証できない。**

---

## 1. 対象モデル（再掲）

状態：

$$
\mathbf{x}=
\begin{bmatrix}
\theta \\
\dot{\theta} \\
x \\
\dot{x}
\end{bmatrix}
$$

線形化モデル：

$$
\dot{\mathbf{x}} = A\mathbf{x} + B u
$$

$$
A=
\begin{bmatrix}
0 & 1 & 0 & 0 \\
\frac{(M+m)g}{lM} & 0 & 0 & 0 \\
0 & 0 & 0 & 1 \\
-\frac{mg}{M} & 0 & 0 & 0
\end{bmatrix},
\quad
B=
\begin{bmatrix}
0 \\
-\frac{1}{lM} \\
0 \\
\frac{1}{M}
\end{bmatrix}
$$

---

## 2. 制御対象の本質（不安定極）

角度系だけを抜き出すと：

$$
\ddot{\theta} =
\frac{(M+m)g}{lM}\theta - \frac{1}{lM}u
$$

制御入力が無い場合：

$$
\ddot{\theta} =
\frac{(M+m)g}{lM}\theta
$$

これは

$$
\theta(t) \sim e^{\lambda t}, \quad
\lambda = \sqrt{\frac{(M+m)g}{lM}} > 0
$$

すなわち **指数発散系**である。

→ **元々不安定**

---

## 3. PID制御の構成

角度のみを制御対象とし，

$$
e(t) = \theta_{\text{ref}} - \theta(t)
$$

PID制御則：

$$
u(t) =
K_p e(t)
+ K_i \int e(t)\,dt
+ K_d \frac{de(t)}{dt}
$$

直立保持なので：

$$
\theta_{\text{ref}} = 0
$$

---

## 4. PIDを入れても何が起きるか

### 4.1 理想連続時間（幻想）

- 微分はノイズ無し
- 飽和無し
- 遅延無し

この **理想世界** では、  
適切な $$K_p, K_d$$ を選べば **一応安定** する。

👉 しかしこれは **教材として意味が無い**。

---

### 4.2 現実1：入力飽和

実機では：

$$
|u| \le u_{\max}
$$

倒れ始めると：

$$
K_p \theta \gg u_{\max}
$$

となり、

$$
u \rightarrow \text{飽和}
$$

→ **線形設計が即破綻**

---

### 4.3 現実2：微分項のノイズ増幅

$$
K_d \dot{\theta}
$$

は

- センサノイズ
- 量子化誤差
- サンプリング遅延

を **そのまま増幅** する。

結果：

- 制御入力が振動
- 実効的に $$K_d$$ を下げざるを得ない
- 位相余裕が消える

---

### 4.4 現実3：離散時間化

サンプリング周期 $$T_s$$ を導入すると，

$$
u[k] =
K_p e[k]
+ K_i \sum e[k] T_s
+ K_d \frac{e[k]-e[k-1]}{T_s}
$$

ここで重要なのは：

> **倒立振子の発散速度は速い**

$$
\theta(t+T_s) \approx \theta(t)e^{\lambda T_s}
$$

$$
\lambda T_s \gtrsim 1
$$

となった瞬間、

→ **制御前に倒れる**

---

## 5. シミュレーションで起きる典型例

PID単体で必ず起きるパターン：

1. 小さな初期角  
   → 立つ
2. 少し大きな初期角  
   → 飽和 → 発散
3. ノイズ追加  
   → 微分暴走
4. サンプリング周期増大  
   → 不安定化

**「条件付きでしか成立しない」**

---

## 6. ここでの結論（重要）

PIDは：

- ❌ 不安定系を根本的に救えない
- ❌ 動作範囲を自分で判断できない
- ❌ 飽和・モードを意識できない

PIDが悪いのではない。

> **役割を超えた使い方をしている**

---

## 7. 次章への必然

ここで自然に出る要求は：

- 大振幅か？
- 小振幅か？
- 制御を切り替えるべきか？
- もう手遅れか？

PIDは **判断できない**。

👉 そこで **FSM（Finite State Machine）** を上に載せる。

---

## 8. 次章予告

**10-3 FSMオーバレイ制御**

- PIDはそのまま
- 上位で「使い分けるだけ」
- **それでも効かないケースも、正直に出す**

---

## チェックリスト

- [ ] 不安定極を明示した
- [ ] PIDの幻想と現実を切った
- [ ] 飽和・離散化を外さなかった
- [ ] FSM導入の必然を作った
