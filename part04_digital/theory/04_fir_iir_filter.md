# 📡 04. FIR/IIR フィルタ設計と応答特性（Digital Filters: FIR & IIR）

ディジタル信号処理の中心的技術である **FIR/IIRフィルタ**は、  
制御系でも**ノイズ除去**や**信号平滑化**、**前処理**などに広く応用されます。

---

## 🎯 学習目標

- FIR（有限インパルス応答）と IIR（無限インパルス応答）の違いを理解する  
- 離散時間でのフィルタの構造と数式表現を学ぶ  
- Pythonで基本的なFIR/IIRを設計・可視化できる  
- 雑音除去・周波数帯域制限の実用例を体験する

---

## 🔁 FIR vs IIR フィルタの構造比較

| 項目        | FIRフィルタ                 | IIRフィルタ                        |
|-------------|-----------------------------|------------------------------------|
| 応答        | 有限インパルス応答         | 無限インパルス応答                 |
| 構造        | 遅延と加算のみ             | 遅延・加算に加えてフィードバックあり |
| 安定性      | 常に安定                    | 極が単位円内であれば安定          |
| 計算負荷    | 多め（次数が高くなる）     | 少なめ（次数が小さくても鋭い特性）|
| 設計容易性  | 線形位相が実現しやすい     | 位相特性が複雑                     |

---

## 🧮 離散時間フィルタの数式表現

### FIRフィルタ：

$$
y[k] = b_0 x[k] + b_1 x[k-1] + \cdots + b_N x[k-N]
$$

- 離散畳み込みに相当

### IIRフィルタ：

$$
y[k] = b_0 x[k] + \cdots + b_N x[k-N] - a_1 y[k-1] - \cdots - a_M y[k-M]
$$

- 入力と出力の両方にフィードバック

---

## 🧩 Z変換での表現

- FIR: $H(z) = \sum_{i=0}^N b_i z^{-i}$  
- IIR: $H(z) = \frac{B(z)}{A(z)} = \frac{b_0 + \cdots + b_N z^{-N}}{1 + a_1 z^{-1} + \cdots + a_M z^{-M}}$

---

## 🧪 Pythonによる基本設計例（次章にて）

- `scipy.signal` によるフィルタ設計：
  - FIR：`firwin()`, `lfilter()` など
  - IIR：`butter()`, `cheby1()`, `freqz()` など

### 実験内容：

- 1kHzサンプリング、50Hz + 300Hzの合成波形を入力  
- FIR/IIRそれぞれのLPFを設計して高周波を除去  
- 時系列応答 + 周波数応答を可視化（Bodeプロット）

---

## 🧠 フィルタ選択の目安（制御用途）

| 目的            | 推奨タイプ     | 理由                           |
|------------------|----------------|--------------------------------|
| センサノイズ除去 | FIR（簡単） or IIR（応答重視） | LPFで高周波除去 |
| スパイク除去     | 移動平均FIR    | 平滑化が効く                    |
| 位相遅れを避けたい| FIR（線形位相）| 音響・通信系など                |

---

## 📚 参考資料

- Proakis, *Digital Signal Processing*  
- Oppenheim & Schafer, *Discrete-Time Signal Processing*  
- Scipy documentation: [scipy.signal](https://docs.scipy.org/doc/scipy/reference/signal.html)

---
