# ⏱️ 01. サンプリングとディジタル制御の基礎（Sampling Theory for Digital Control）

現代の制御系は、マイコン・DSP・FPGAなどの**ディジタル装置**を通じて実装されます。  
この章では、連続時間制御から**離散時間制御**への橋渡しとなる**サンプリング理論**を学びます。

---

## 🎯 学習目標

- サンプリングとゼロ次ホールド（ZOH）の概念を理解する  
- ナイキスト定理とエイリアシングの危険性を説明できる  
- サンプリング周期 $T_s$ の設計指針を知る  
- 離散化における情報の損失や遅延を意識できる

---

## 📏 アナログとディジタルの違い

| 項目 | アナログ系（連続時間） | ディジタル系（離散時間） |
|------|--------------------------|----------------------------|
| 時間 | 連続 $t$                 | 離散 $kT_s$                |
| 処理 | 微分方程式              | 差分方程式                 |
| 実装 | 回路、アナログ演算     | マイコン、DSP、FPGAなど   |

---

## 📐 サンプリングとは？

- 時間的に連続な信号 $x(t)$ を、周期 $T_s$ で離散化する処理  
- 離散信号： $x[k] = x(kT_s)$

### ゼロ次ホールド（ZOH）

- 離散信号を連続系に戻すときに「**前の値を保持する**」方式  
- 実機マイコンのD/A変換器の多くがこの方式を採用

---

## 📈 ナイキスト定理（Nyquist Theorem）

- **正確に再現するには $f_s > 2f_{\text{max}}$**（　$f_{\text{max}}$  ：信号中の最大周波数）  
- **$f_s$ ：サンプリング周波数、 $T_s = 1/f_s$**

### エイリアシング（aliasing）

- サンプリングが不十分だと、高周波成分が**誤って低周波に見える**
- 対策：
  - サンプリング前に**ローパスフィルタ（アンチエイリアス）**
  - 十分に高いサンプリング周波数を選定

---

## 🧠 サンプリング周期の設計指針

- 一般に「**閉ループ帯域の10倍以上**」が目安：
  - 閉ループの立ち上がり時間 $T_r$ に対し、 $T_s < T_r / 10$
- 遅すぎると：
  - 応答遅延、振動、安定性悪化の原因に
- 速すぎると：
  - 実装負荷、演算量・通信量の増加に

---

## 🧪 実験例（後続スクリプト）

- 同じ1次系に対して、 $T_s = 0.01$  , $0.1$ , $0.5$ などで応答を比較  
- サンプリングが遅くなると、以下の現象が観察できる：
  - 応答の遅延
  - 量子化・ステップ状の出力
  - 極端には発散・不安定化

---

## 📚 参考資料

- Ogata, *Discrete-Time Control Systems*  
- Franklin et al., *Digital Control of Dynamic Systems*  
- 岡部洋一『ディジタル制御入門』

---
