# 📘 04. サブスペース同定法（Subspace Identification）

本節では、**入力–出力データに基づいて状態空間モデルを推定**する手法、  
サブスペース同定法（Subspace Identification）について解説します。

---

## 🎯 サブスペース同定とは？

- 時系列データ（入出力）から状態空間モデル $A, B, C, D$ を直接構築
- ノイズに強く、SVD（特異値分解）を用いた安定な推定が可能
- 多変数系（MIMO）やブラックボックス系に有効

---

## 🧠 数学的背景（簡略）

状態空間モデル：

$$
\begin{aligned}
x_{k+1} &= A x_k + B u_k \\
y_k &= C x_k + D u_k
\end{aligned}
$$

入力 $u_k$、出力 $y_k$ の系列から、**回帰行列やハンケル行列**を構成し、  
SVD を通じて内部状態の次元とモデル行列を抽出します。

---

## 🔧 主なステップ（N4SIDアルゴリズム例）

1. データ系列 $\{u_k, y_k\}$ を収集  
2. ハンケル行列（時系列の履歴）を構成  
3. SVDにより系の次数（状態次元）を推定  
4. 観測行列・状態遷移行列 $A, B, C, D$ を推定  
5. 得られたモデルの予測精度や再現性を検証

---

## 📈 特徴と利点

| 項目 | 内容 |
|------|------|
| 必要データ | 入力–出力系列 |
| ノイズ耐性 | 高い（SVDにより安定） |
| 系の次数選定 | 自動・半自動で可能 |
| 拡張性 | MIMO, 時不変・時変系にも対応 |

---

## 🧪 本教材での実装例

- ファイル：[`subspace_identification.py`](../simulation/subspace_identification.py)

> 実験では、Python + NumPy + SciPy により小規模系の識別を行います。

---

## 💡 備考

- MATLABの `n4sid()` 関数で広く利用されている手法
- Pythonでは `pyN4SID` や `control.matlab` 相当の実装が必要
- KoopmanやDMDと異なり、**状態ベースの再構築が主目的**

---

## 🔚 まとめ

サブスペース同定法は、**モデルベース制御への橋渡し**として有効な識別法です。  
次節では、こうしたデータ駆動手法と従来モデルの統合について考察します。

📁 次へ：[`05_data_vs_model.md`](./05_data_vs_model.md)

---

