# 🔍 03. 動的モード分解（DMD：Dynamic Mode Decomposition）

本節では、観測データに基づいて力学系の振る舞いを抽出する手法である  
**動的モード分解（DMD）** について解説します。これはKoopman理論の一部としても位置づけられます。

---

## 🎯 DMDの概要

- 非線形・未知の力学系に対して、**観測データから線形近似モデルを構築**
- 多自由度システムや時系列信号の「モード成分」を抽出可能
- モデル構築不要で、**データ駆動型の予測・解析**が可能

---

## 🧠 数理モデル

観測系列 $\{x_1, x_2, \dots, x_m\}$ を以下のように構成：

$$
X = [x_1, x_2, \dots, x_{m-1}], \quad X' = [x_2, x_3, \dots, x_m]
$$

DMDの目標は、$X'$ を $X$ によって最もよく近似する線形写像 $A$ を求めること：

$$
X' pprox A X
$$

この $A$ の固有分解（またはSVD）によって、**動的モード** を抽出します。

---

## 📐 DMDの計算ステップ

1. 入力データ系列を $X$, $X'$ に分解  
2. SVD分解：
   $$
   X = U \Sigma V^T
   $$
3. 低次元DMD行列：
   $$
   	ilde{A} = U^T X' V \Sigma^{-1}
   $$
4. 固有値・固有ベクトルの解析により、**モード・成長率・振動数**を抽出

---

## 📊 応用例

- 流体シミュレーションのモード解析
- 建物振動の状態推定
- 複雑システムの次元削減と予測

---

## 🛠️ 本教材での実装

- ファイル：[`dmd_analysis.py`](../simulation/dmd_analysis.py)
- Notebook：[`koopman_vs_dmd_visual.ipynb`](../notebooks/koopman_vs_dmd_visual.ipynb)

---

## 💡 DMDとKoopmanの関係

| 観点 | DMD | Koopman |
|------|-----|---------|
| アプローチ | データから近似線形写像 | 関数空間の線形作用素 |
| 必要データ | 状態系列 $x_t$ | 状態・入力・出力などの関数空間 |
| 制御との統合 | 制限的（予測用） | 制御設計が可能（線形系に変換） |

---

## 🔚 まとめ

DMDは、「モデルレスで予測可能な線形系」を観測から得る代表的な手法です。  
次節では、より制御指向なモデル構築手法である「サブスペース同定法」を学びます。

📁 次へ：[`04_subspace_id.md`](./04_subspace_id.md)

---
