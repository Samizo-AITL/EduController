# 📈 02. Koopman演算子と線形化（Koopman Operator Theory）

本節では、非線形力学系を**高次元空間上で線形系として扱う**という発想に基づく  
**Koopman演算子理論**と、その制御応用について解説します。

---

## 📚 背景：非線形系の困難さ

多くの実システムは非線形であり、伝統的な線形制御手法では扱いにくいです。  
Koopman理論は、非線形系を「関数空間上の線形作用素」として捉えることで、  
**非線形→線形制御**への橋渡しを行います。

---

## 🧠 基本アイデア

- 元の力学系：
  $x_{t+1} = f(x_t)$

- 観測関数（可視化・計測可能な量） $\psi(x)$ を定義し、
  Koopman演算子 $\mathcal{K}$ により以下を満たす：

  $\psi(x_{t+1}) = \mathcal{K} \psi(x_t)$

つまり、**非線形な状態遷移 $f$ を、$\psi$ を介して線形作用素 $\mathcal{K}$ で記述**。

---

## 🛠️ 制御応用の流れ（Koopman制御）

1. 系の観測データ $(x_t, x_{t+1})$ を多数取得  
2. 観測関数 $\psi(x)$ を適用し、線形近似 $\mathcal{K}$ を構築（線形回帰など）  
3. 得られた線形系上で LQR や MPC を設計  
4. 元の状態空間に逆変換して制御入力を適用

---

## 📈 Koopman制御の数式モデル（例）

1. 状態変換：
   $z_t = \psi(x_t)$

2. 線形モデル：
   $z_{t+1} = A z_t + B u_t$

4. 出力変換：
   $x_t = C z_t$

---

## 📎 応用のポイント

- $\psi(x)$ の選び方が極めて重要（多項式、RBF、Autoencoder等）  
- 非線形系をグローバルに線形化する試み  
- 動的モード分解（DMD）はKoopmanの特別なケース

---

## 🧪 本教材での実装

- ファイル：[`koopman_linearization.py`](../simulation/koopman_linearization.py)
- ノートブック：[`koopman_vs_dmd_visual.ipynb`](../notebooks/koopman_vs_dmd_visual.ipynb)

> ⚠️ Koopman行列 $A, B, C$ の推定は、回帰やSVDなどを用いて行われます。

---

## 🔚 まとめ

Koopman理論は、**非線形→線形制御**の橋渡しを行う新しい枠組みです。  
次節では、この理論の出発点とも言える「動的モード分解（DMD）」を詳しく見ていきます。

📁 次へ：[`03_dmd.md`](./03_dmd.md)

---
